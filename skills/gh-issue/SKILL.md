---
name: gh-issue
description: Review and update GitHub issue description, labels, and details.
---

# Update Issue

Issueの説明文を確認し、必要に応じて分析コメントを追記する。

## 引数パターン

| 引数 | 動作 |
|------|------|
| `/.gh-issue 1234` | Issue #1234 を処理 |
| `/.gh-issue` | 8件取得してAskで確認後、一括処理 |

## ワークフロー

### 引数でIssue番号が指定された場合

単一のIssueを処理する。

### 引数が空の場合

#### Step 1: Issue一覧を取得（最終更新日順、8件）

```bash
gh issue list --state open --limit 8 --json number,title,body,author,updatedAt | jq 'sort_by(.updatedAt) | reverse'
```

#### Step 2: 未分析のIssueを抽出

bodyに `※ Generated by Claude` が含まれていないIssueを抽出。

#### Step 3: AskUserQuestionで確認

```
以下のIssueに分析コメントを追記しますか？

#1234 タイトル1
#5678 タイトル2
...
```

#### Step 4: 承認されたら一括処理

サブエージェント (haiku) で並列分析し、各Issueに追記。

## 単一Issue処理のワークフロー

### ステップ1: Issueの内容を取得

```bash
gh issue view <issue番号> --json body,title,author,assignees,comments
```

### ステップ2: 分析コメントの確認

Issue bodyに `>` で始まる分析コメント（`※ Generated by Claude` を含む）があるか確認する。

- **あり**: 内容を確認し、必要なら更新
- **なし**: 分析して追記

### ステップ3: 不明点の判断

Issueの内容を確認し、実装に必要な情報が不足しているか判断する。

- **情報十分**: 分析コメントをbodyに追記
- **情報不足**: Issueにコメントを投稿して質問

### ステップ4: 更新内容を提案

AskUserQuestionで確認してから実行する。

## 分析コメントのフォーマット

### 通常パターン（取り組みやすさの分析）

bodyの末尾に追記:

```markdown
> 要件が明確で、既存パターンを踏襲すれば実装できます。※ Generated by Claude
```

### 不明点がある場合（Issueにコメント投稿）

不明点がある場合は、bodyへの追記ではなく **Issueにコメントを投稿** して質問する。

```bash
gh issue comment {番号} --body "@username 以下の点について確認をお願いします。

- 質問1
- 質問2

> ※ Generated by Claude"
```

メンション先の判断基準:
- Issue作成者: 要件の詳細を知っている可能性が高い
- アサインされた人: 実装担当として把握している可能性
- コメント参加者: 直近で議論に参加している人

投稿前にAskUserQuestionで確認すること。

## シンプルなテンプレート

```markdown
## 概要

[作業の目的・背景]

## 対応内容

- [ ] タスク1
- [ ] タスク2

## 備考
```
